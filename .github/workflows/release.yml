# 版本发布

name: release

on:
<<<<<<< HEAD
  push:
    branches:
      - release
    tags:
      - 'v*'
=======
  release:
    types: [published]
>>>>>>> main

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v2
      - name: Display dotnet version
        run: dotnet --version
      - name: Install dependencies
        run: dotnet restore
      - name: Build
        run: dotnet build --configuration Release
      - name: Create the package
        run: dotnet pack --configuration Release
<<<<<<< HEAD
#      - name: Publish the package to GPR
#        id: publish_nuget
#        uses: rohith/publish-nuget@v2.5.5
#        with:
#          PROJECT_FILE_PATH: src/DotNet/DotNet.csproj
#          NUGET_KEY: ${{secrets.NUGET_API_SECRET}}
##          NUGET_SOURCE: https://api.nuget.org/
#          TAG_FORMAT: v*
#          PACKAGE_NAME: DotNetFool
=======

  publish:
    needs: [build]
    runs-on: ubuntu-latest

    steps:
      - name: Publish the package to GPR
        id: publish_nuget
        uses: rohith/publish-nuget@v2.5.5
        with:
          PROJECT_FILE_PATH: src/DotNet/DotNet.csproj
          NUGET_KEY: ${{secrets.NUGET_API_SECRET}}
          TAG_FORMAT: v*
          PACKAGE_NAME: DotNetFool-${{github.event.release.tag_name}}
>>>>>>> main
